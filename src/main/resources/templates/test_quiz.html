<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/css/test_quiz.css">
    <script src="/js/style.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Sawarabi+Gothic" rel="stylesheet">
    <title>Test-quiz</title>

</head>
<body>

<form name="form_countdown">
    <input name="counter" type="text" value="5"  style="border:none; background-color:transparent;">
</form>

<div class="quiz_zentai">
    <div class="marudisplay" id="marudisplay">
        <img src="/images/test/maru.png">
    </div>

    <div class="hazuredisplay" id="hazuredisplay">
        <img src="/images/test/batu.png">
    </div>

    <div class="tugiedisplay" id="tugiedisplay">
        <form th:action="@{/sense/test_question/{id}(id=${nextId})}" method="get" />
        　<input type="image" src="/images/test/nextquestion.png"/>　　　　　　　
        </form>
    </div>

    <div class = "resultButtonDisplay" id = "resultButtonDisplay">
        <form th:action="@{/sense/test_result/{id}(id=${nextId})}" method="get">
        　<input type="submit"  th:value="結果" method="get" >　　　　　　　
        </form>
    </div>

    <script>
        var maruimg = document.getElementById('marudisplay');
        var hazureimg = document.getElementById('hazuredisplay');
        var tugieimg = document.getElementById('tugiedisplay');
        var resultButtonImg = document.getElementById('resultButtonDisplay');

        resultButtonImg.style.display = "none"
        maruimg.style.display = "none";
        hazureimg.style.display = "none";
        tugieimg.style.display  = "none";
        function changepage(id) {
            tugieimg.style.display = "block";
            if (id == 1) {
                maruimg.style.display = "block";
                setTimeout(function change() {
                    maruimg.style.display = "none";
                }, 1000);
                location.href= unload();
                tugieimg.style.display = "block";
                countstop();
            }
            else if (id == 2) {
                tugieimg.style.display = "none";
                hazureimg.style.display = "block";
                setTimeout(function change() {
                    window.location.href = '/sense/test_question/1';
                }, 1000);
                countstop();
            }
            else if(id == 0){
                maruimg.style.display = "block";
                tugieimg.style.display = "none";
                setTimeout(function change() {
                    maruimg.style.display = "none";
                    resultButtonImg.style.display = "block";
                }, 1000);
                location.href= unload();
                countstop();
            }
        }
        window.onload =function countstart() {
            count = eval(document.form_countdown.counter.value);
            timerID = setInterval('countdown()',1000);
            document.form_countdown.start.disabled = true; //開始ボタンを使用禁止
        }

        function countstop() {
            clearInterval(timerID);
            document.form_countdown.start.disabled = false; //開始ボタンを解除
            document.form_countdown.reset(); //初期値に戻す
        }

        function countdown() {

            document.form_countdown.counter.value= count; //カウント表示
            count--; //カウントダウン
            if (count < 0) countstop();
            {
                setTimeout(function change() {
                    location.href = "/sense/test_question/1";
                }, 5000)
            };
            //カウント終了 */
        }

    </script>

    <div class="test_eigo">
        <tr  th:object="${words}">
            <td th:text="*{word}"></td>
        </tr>
    </div>

    <br><br>

    <div class="test_nihongo">
        <div th:each=" word : ${words.getShuffledAnswers()}">
            <div th:each=" option : ${words}">

                <div th:if="${lastid}">
                    <div th:switch="${word}">
                          <span th:case="${option.meaning}" onClick="changepage(0)">
                              <div class="nihongo_btn" th:text="${word}"></div>
                          </span>

                          <span th:case="*" onClick="changepage(2)">
                              <div class="nihongo_btn" th:text="${word}" ></div>
                              <form th:action="@{/sense/test_quiz/}" method="get" />　
                              </form>
                          </span>
                    </div>
                </div>

                <div th:unless="${lastid}">
                     <div th:switch="${word}">
                          <span th:case="${option.meaning}" onClick="changepage(1)">
                              <div class="nihongo_btn" th:text="${word}"></div>
                          </span>

                          <span th:case="*" onClick="changepage(2)">
                              <div class="nihongo_btn" th:text="${word}" ></div>
                              <form th:action="@{/sense/test_quiz/}" method="get" />　
                              </form>
                          </span>
                      </div>
                </div>
            </div>
        </div>
    </div>

    <a class="homeback" href="/sense/mypage"><img src="/images/mypage/home.png"></a>

</div>
</body>
</html>
